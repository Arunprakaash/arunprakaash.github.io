<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">



<link rel="icon" type="image/ico" href="https://arunprakaash.github.io//favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://arunprakaash.github.io//favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://arunprakaash.github.io//favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="https://arunprakaash.github.io//android-chrome-192x192.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://arunprakaash.github.io//apple-touch-icon.png">

<meta name="description" content="Dive into the world of reinforcement learning with this fun and interactive guide to the k-armed bandit problem. Learn through real-world analogies and hands-on exercises that take you from casino slot machines to medical treatments and stock market investments."/>



<title>
    
    K-Armed Bandit Problem: From Casinos to Wall Street | arun._space
    
</title>

<link rel="canonical" href="https://arunprakaash.github.io/curiosities/2024-10-09/k-armed-bandit-problem/"/>

<meta property="og:url" content="https://arunprakaash.github.io/curiosities/2024-10-09/k-armed-bandit-problem/">
  <meta property="og:site_name" content="arun._space">
  <meta property="og:title" content="K-Armed Bandit Problem: From Casinos to Wall Street">
  <meta property="og:description" content="Dive into the world of reinforcement learning with this fun and interactive guide to the k-armed bandit problem. Learn through real-world analogies and hands-on exercises that take you from casino slot machines to medical treatments and stock market investments.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="curiosities">
    <meta property="article:published_time" content="2024-10-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-09T00:00:00+00:00">
    <meta property="article:tag" content="Reinforcement Learning">
    <meta property="article:tag" content="Exploration vs Exploitation">
    <meta property="article:tag" content="Decision Making">
    <meta property="article:tag" content="K-Armed Bandit">













<link rel="stylesheet" href="/assets/combined.min.a904013acd8e3bd04ce56a64a8fe5525fd5f738ad6caa0bfbcbe39a8d7ed932d.css" media="all">









</head>







<body class="auto">

  <div class="content">
    <header>
      

<div class="header">

    

    <h1 class="header-title">
        <a href="https://arunprakaash.github.io/">arun._space</a>
    </h1>

    <div class="flex">
        

        
        
      
        <p class="small ">
            <a href="/" >
                //
            </a>
        </p>
        
      
        <p class="small ">
            <a href="/curiosities" >
                /Curiosities
            </a>
        </p>
        
      
        <p class="small ">
            <a href="/about" >
                /About
            </a>
        </p>
        
        
    </div>

    

</div>

    </header>

    <main class="main">
      





<div class="breadcrumbs">
    
    <a href="/">Home</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a href="/curiosities/">Curiosities</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a class="breadcrumbs-current" href="/curiosities/2024-10-09/k-armed-bandit-problem/">K-Armed Bandit Problem: From Casinos to Wall Street</a>
</div>



<div  class="autonumber" >

  <div class="single-intro-container">

    

    <h1 class="single-title">K-Armed Bandit Problem: From Casinos to Wall Street</h1>
    
    <p class="single-summary">An engaging exploration of the k-armed bandit problem, covering key concepts like exploration vs. exploitation, continuous rewards, and non-stationary environments.</p>
    

    

    <p class="single-readtime">
      
      
      
      <time datetime="2024-10-09T00:00:00&#43;00:00">October 9, 2024</time>
      

      
      &nbsp; · &nbsp;
      7 min read
      
    </p>

  </div>

  

  

  
  <aside class="toc">
    <p><strong>Table of contents</strong></p>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#the-casino-of-uncertainty">The Casino of Uncertainty</a></li>
    <li><a href="#key-concepts-your-gambling-toolkit">Key Concepts: Your Gambling Toolkit</a>
      <ul>
        <li><a href="#action-values-the-hidden-jackpot">Action Values: The Hidden Jackpot</a></li>
        <li><a href="#estimating-values-reading-the-crystal-ball">Estimating Values: Reading the Crystal Ball</a></li>
        <li><a href="#the-greedy-gambler-always-bet-on-the-best">The Greedy Gambler: Always Bet on the Best?</a></li>
        <li><a href="#exploration-vs-exploitation-the-gamblers-dilemma">Exploration vs. Exploitation: The Gambler&rsquo;s Dilemma</a></li>
      </ul>
    </li>
    <li><a href="#a-mathematical-interlude-the-power-of-incremental-updates">A Mathematical Interlude: The Power of Incremental Updates</a></li>
    <li><a href="#when-the-tides-turn-non-stationary-problems">When the Tides Turn: Non-Stationary Problems</a></li>
    <li><a href="#the-great-casino-experiment">The Great Casino Experiment</a></li>
    <li><a href="#the-lesson-learned">The Lesson Learned</a></li>
    <li><a href="#beyond-the-casino-real-world-applications">Beyond the Casino: Real-World Applications</a></li>
    <li><a href="#advanced-strategies-leveling-up-your-game">Advanced Strategies: Leveling Up Your Game</a>
      <ul>
        <li><a href="#optimistic-initial-values-the-power-of-positivity">Optimistic Initial Values: The Power of Positivity</a></li>
        <li><a href="#upper-confidence-bound-ucb-algorithm">Upper Confidence Bound (UCB) Algorithm</a></li>
        <li><a href="#thompson-sampling-bayesian-bandits">Thompson Sampling: Bayesian Bandits</a></li>
      </ul>
    </li>
    <li><a href="#continuous-rewards-when-life-isnt-just-win-or-lose">Continuous Rewards: When Life Isn&rsquo;t Just Win or Lose</a>
      <ul>
        <li><a href="#gaussian-bandits">Gaussian Bandits</a></li>
        <li><a href="#updating-beliefs-with-continuous-rewards">Updating Beliefs with Continuous Rewards</a></li>
      </ul>
    </li>
    <li><a href="#multi-armed-bandits-in-the-wild-case-studies">Multi-Armed Bandits in the Wild: Case Studies</a>
      <ul>
        <li><a href="#netflixs-artwork-selection">Netflix&rsquo;s Artwork Selection</a></li>
        <li><a href="#googles-adwords">Google&rsquo;s AdWords</a></li>
      </ul>
    </li>
    <li><a href="#ethical-considerations-the-dark-side-of-bandits">Ethical Considerations: The Dark Side of Bandits</a></li>
    <li><a href="#the-road-ahead-frontiers-in-bandit-research">The Road Ahead: Frontiers in Bandit Research</a></li>
    <li><a href="#food-for-thought">Food for Thought</a></li>
  </ul>
</nav>
  </aside>
  

  

  <div class="single-content">
    <h1 class="heading" id="the-gamblers-dilemma-unraveling-the-k-armed-bandit-problem">
  The Gambler&rsquo;s Dilemma: Unraveling the K-Armed Bandit Problem
  <a href="#the-gamblers-dilemma-unraveling-the-k-armed-bandit-problem">#</a>
</h1>
<p>Imagine you&rsquo;re in a dazzling casino, surrounded by a sea of slot machines. Each machine promises riches, but which one should you choose? Welcome to the world of the K-Armed Bandit Problem, where decision-making meets probability in a thrilling dance of risk and reward!</p>
<h2 class="heading" id="the-casino-of-uncertainty">
  The Casino of Uncertainty
  <a href="#the-casino-of-uncertainty">#</a>
</h2>
<p>In this glittering palace of chance, you&rsquo;re faced with k different slot machines (or &ldquo;bandits&rdquo;). Each pull of the lever (an &ldquo;action&rdquo;) results in a reward, but here&rsquo;s the twist: you don&rsquo;t know the payout probabilities of each machine. Your mission, should you choose to accept it, is to maximize your winnings over time.</p>
<h2 class="heading" id="key-concepts-your-gambling-toolkit">
  Key Concepts: Your Gambling Toolkit
  <a href="#key-concepts-your-gambling-toolkit">#</a>
</h2>
<h3 class="heading" id="action-values-the-hidden-jackpot">
  Action Values: The Hidden Jackpot
  <a href="#action-values-the-hidden-jackpot">#</a>
</h3>
<p>Each bandit has a secret &ldquo;action value&rdquo; - the expected reward for pulling its lever. We represent this mathematically as:</p>
<p>$$q_*(a) = \mathbb{E}[R_t | A_t = a]$$</p>
<p>Where $q_*(a)$ is the true value of action $a$, $R_t$ is the reward at time $t$, and $A_t$ is the action taken at time $t$.</p>
<h3 class="heading" id="estimating-values-reading-the-crystal-ball">
  Estimating Values: Reading the Crystal Ball
  <a href="#estimating-values-reading-the-crystal-ball">#</a>
</h3>
<p>Since we can&rsquo;t peek inside the machines, we need to estimate their values based on our observations. Enter the sample-average method:</p>
<p>$$Q_t(a) = \frac{\text{sum of rewards when } a \text{ taken prior to } t}{\text{number of times } a \text{ taken prior to } t}$$</p>
<h3 class="heading" id="the-greedy-gambler-always-bet-on-the-best">
  The Greedy Gambler: Always Bet on the Best?
  <a href="#the-greedy-gambler-always-bet-on-the-best">#</a>
</h3>
<p>The simplest strategy is to always choose the machine with the highest estimated value:</p>
<p>$$A_t = \arg\max_a Q_t(a)$$</p>
<p>But is this the wisest choice? 🤔</p>
<h3 class="heading" id="exploration-vs-exploitation-the-gamblers-dilemma">
  Exploration vs. Exploitation: The Gambler&rsquo;s Dilemma
  <a href="#exploration-vs-exploitation-the-gamblers-dilemma">#</a>
</h3>
<ul>
<li><strong>Exploitation</strong>: Stick with the machine that seems best (maximize short-term gains)</li>
<li><strong>Exploration</strong>: Try other machines to gather more information (potentially improve long-term gains)</li>
</ul>
<p>This is the core dilemma of our casino adventure!</p>
<h2 class="heading" id="a-mathematical-interlude-the-power-of-incremental-updates">
  A Mathematical Interlude: The Power of Incremental Updates
  <a href="#a-mathematical-interlude-the-power-of-incremental-updates">#</a>
</h2>
<p>As we play, we need to update our estimates efficiently. Behold the magic of incremental updates:</p>
<p>$$Q_{n+1} = Q_n + \frac{1}{n}(R_n - Q_n)$$</p>
<p>This elegant formula allows us to update our estimates without storing all previous rewards. It&rsquo;s like having a tiny abacus in our pocket!</p>
<h2 class="heading" id="when-the-tides-turn-non-stationary-problems">
  When the Tides Turn: Non-Stationary Problems
  <a href="#when-the-tides-turn-non-stationary-problems">#</a>
</h2>
<p>But wait! What if the casino owner sneakily changes the payout probabilities over time? We&rsquo;ve entered the realm of non-stationary problems. Fear not, for we have a solution:</p>
<p>$$Q_{n+1} = Q_n + \alpha(R_n - Q_n)$$</p>
<p>By using a constant step size $\alpha$, we can adapt to changing probabilities. It&rsquo;s like having a weather vane for casino winds!</p>
<h2 class="heading" id="the-great-casino-experiment">
  The Great Casino Experiment
  <a href="#the-great-casino-experiment">#</a>
</h2>
<p>Let&rsquo;s put our knowledge to the test with a whimsical example:</p>
<p>Imagine three slot machines named Glitter, Sparkle, and Shine. Unknown to us, their true payout probabilities are:</p>
<ul>
<li>Glitter: 30% chance of winning $5</li>
<li>Sparkle: 20% chance of winning $10</li>
<li>Shine: 10% chance of winning $20</li>
</ul>
<p>We start with 100 plays, using an ε-greedy strategy (ε = 0.1). Here&rsquo;s what might happen:</p>
<ol>
<li>Early exploration reveals Sparkle as promising.</li>
<li>We exploit Sparkle for a while, racking up wins.</li>
<li>Occasional exploration of Shine yields big wins, shifting our preference.</li>
<li>By the end, we&rsquo;ve discovered Shine&rsquo;s higher expected value, despite its lower win frequency.</li>
</ol>
<h2 class="heading" id="the-lesson-learned">
  The Lesson Learned
  <a href="#the-lesson-learned">#</a>
</h2>
<p>The K-Armed Bandit Problem teaches us that in the face of uncertainty, a balance of exploration and exploitation is key. It&rsquo;s not just about gambling – this principle applies to everything from A/B testing in marketing to drug trials in medicine!</p>
<h2 class="heading" id="beyond-the-casino-real-world-applications">
  Beyond the Casino: Real-World Applications
  <a href="#beyond-the-casino-real-world-applications">#</a>
</h2>
<ol>
<li><strong>Recommendation Systems</strong>: Streaming services use similar algorithms to suggest content.</li>
<li><strong>Clinical Trials</strong>: Balancing the need to help current patients with gathering data for future treatments.</li>
<li><strong>Portfolio Management</strong>: Deciding how to allocate investments across different options.</li>
</ol>
<h2 class="heading" id="advanced-strategies-leveling-up-your-game">
  Advanced Strategies: Leveling Up Your Game
  <a href="#advanced-strategies-leveling-up-your-game">#</a>
</h2>
<h3 class="heading" id="optimistic-initial-values-the-power-of-positivity">
  Optimistic Initial Values: The Power of Positivity
  <a href="#optimistic-initial-values-the-power-of-positivity">#</a>
</h3>
<p>Before we dive into more complex strategies, let&rsquo;s explore a simple yet powerful technique: optimistic initial values.</p>
<p>The idea is straightforward: instead of starting with zero or average estimates for each arm, we begin with high, optimistic values. This approach encourages early exploration by making all options seem attractive at first.</p>
<p>Here&rsquo;s how it works:</p>
<ol>
<li>Set initial Q-values higher than the expected true values.</li>
<li>As the algorithm explores, it will naturally &ldquo;discover&rdquo; that some arms aren&rsquo;t as good as initially thought.</li>
<li>This leads to a balanced exploration of all arms before settling on the best ones.</li>
</ol>
<p>Mathematically, we might initialize our Q-values like this:</p>
<p>$$Q_0(a) = c, \quad \text{for all } a$$</p>
<p>Where $c$ is a constant chosen to be higher than the expected rewards.</p>
<p>This method is particularly effective in stationary environments and can lead to faster convergence to optimal strategies.</p>
<h3 class="heading" id="upper-confidence-bound-ucb-algorithm">
  Upper Confidence Bound (UCB) Algorithm
  <a href="#upper-confidence-bound-ucb-algorithm">#</a>
</h3>
<p>While ε-greedy balances exploration and exploitation, the UCB algorithm takes a more sophisticated approach:</p>
<p>$$A_t = \arg\max_a \left[Q_t(a) + c\sqrt{\frac{\ln t}{N_t(a)}}\right]$$</p>
<p>Where:</p>
<ul>
<li>$c$ controls the degree of exploration</li>
<li>$t$ is the total number of plays</li>
<li>$N_t(a)$ is the number of times action $a$ has been chosen</li>
</ul>
<p>UCB favors actions with high estimated values and those that haven&rsquo;t been tried much, providing a more nuanced exploration strategy.</p>
<h3 class="heading" id="thompson-sampling-bayesian-bandits">
  Thompson Sampling: Bayesian Bandits
  <a href="#thompson-sampling-bayesian-bandits">#</a>
</h3>
<p>For those who love probability, Thompson Sampling offers a Bayesian approach:</p>
<ol>
<li>Maintain a probability distribution for each arm&rsquo;s reward</li>
<li>Sample from each distribution</li>
<li>Choose the arm with the highest sampled value</li>
</ol>
<p>This method naturally balances exploration and exploitation based on our uncertainty about each arm.</p>
<h2 class="heading" id="continuous-rewards-when-life-isnt-just-win-or-lose">
  Continuous Rewards: When Life Isn&rsquo;t Just Win or Lose
  <a href="#continuous-rewards-when-life-isnt-just-win-or-lose">#</a>
</h2>
<p>In many real-world scenarios, rewards aren&rsquo;t binary. Let&rsquo;s explore how to handle continuous rewards:</p>
<h3 class="heading" id="gaussian-bandits">
  Gaussian Bandits
  <a href="#gaussian-bandits">#</a>
</h3>
<p>Imagine each slot machine&rsquo;s payout follows a normal distribution. We can model this using:</p>
<p>$$R_t \sim \mathcal{N}(\mu_a, \sigma_a^2)$$</p>
<p>Where $\mu_a$ is the mean payout and $\sigma_a^2$ is the variance for arm $a$.</p>
<h3 class="heading" id="updating-beliefs-with-continuous-rewards">
  Updating Beliefs with Continuous Rewards
  <a href="#updating-beliefs-with-continuous-rewards">#</a>
</h3>
<p>We can use Bayesian updating to refine our estimates of $\mu_a$ and $\sigma_a^2$ as we gather more data. This allows us to make more informed decisions over time.</p>
<h2 class="heading" id="multi-armed-bandits-in-the-wild-case-studies">
  Multi-Armed Bandits in the Wild: Case Studies
  <a href="#multi-armed-bandits-in-the-wild-case-studies">#</a>
</h2>
<h3 class="heading" id="netflixs-artwork-selection">
  Netflix&rsquo;s Artwork Selection
  <a href="#netflixs-artwork-selection">#</a>
</h3>
<p>Netflix uses multi-armed bandit algorithms to choose which artwork to display for each show. Different users see different images, and the algorithm learns which artworks lead to more views.</p>
<h3 class="heading" id="googles-adwords">
  Google&rsquo;s AdWords
  <a href="#googles-adwords">#</a>
</h3>
<p>Google employs bandit algorithms to optimize ad placement and selection, balancing the need to show relevant ads (exploitation) with trying new ad combinations (exploration).</p>
<h2 class="heading" id="ethical-considerations-the-dark-side-of-bandits">
  Ethical Considerations: The Dark Side of Bandits
  <a href="#ethical-considerations-the-dark-side-of-bandits">#</a>
</h2>
<p>As we apply these powerful algorithms, we must consider their ethical implications:</p>
<ol>
<li><strong>Fairness</strong>: Bandit algorithms might perpetuate or exacerbate existing biases if not carefully designed.</li>
<li><strong>Transparency</strong>: In fields like healthcare, it&rsquo;s crucial to explain why certain treatments are chosen over others.</li>
<li><strong>Long-term Impact</strong>: Optimizing for short-term rewards might have unintended long-term consequences.</li>
</ol>
<h2 class="heading" id="the-road-ahead-frontiers-in-bandit-research">
  The Road Ahead: Frontiers in Bandit Research
  <a href="#the-road-ahead-frontiers-in-bandit-research">#</a>
</h2>
<p>As we conclude our journey through the world of K-Armed Bandits, let&rsquo;s peek at some exciting frontiers:</p>
<ol>
<li><strong>Contextual Bandits</strong>: Incorporating additional information to make better decisions</li>
<li><strong>Adversarial Bandits</strong>: Dealing with scenarios where the environment actively tries to deceive the algorithm</li>
<li><strong>Infinite-Armed Bandits</strong>: Tackling problems with an unlimited number of options</li>
</ol>
<p>For those interested in diving deeper into contextual bandits, John Langford&rsquo;s tutorial<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> provides an excellent introduction to the topic. Additionally, the Vowpal Wabbit library<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> offers a range of implementations for various contextual bandit algorithms, making it a valuable resource for practitioners and researchers alike.</p>
<h2 class="heading" id="food-for-thought">
  Food for Thought
  <a href="#food-for-thought">#</a>
</h2>
<p>As you leave our virtual casino, ponder these questions:</p>
<ol>
<li>How might you apply the principles of the K-Armed Bandit Problem to decisions in your own life?</li>
<li>Can you think of a real-world scenario where the exploration-exploitation tradeoff is crucial?</li>
<li>What ethical considerations should we keep in mind when deploying bandit algorithms in sensitive areas like healthcare or finance?</li>
</ol>
<p>Remember, every choice is a pull of the lever in the great slot machine of life. May your algorithms be ever in your favor!</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Langford, J. Contextual Bandit Tutorial. Retrieved from <a href="https://hunch.net/~rwil">https://hunch.net/~rwil</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Vowpal Wabbit. Contextual Bandit Algorithms. Retrieved from <a href="https://vowpalwabbit.org">https://vowpalwabbit.org</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    
    
    <script src="https://giscus.app/client.js"
        data-repo="arunprakaash/arunprakaash.github.io"
        data-repo-id="R_kgDOMQKpEw"
        data-category=""
        data-category-id="DIC_kwDOMQKpE84CjORF"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="noborder_dark"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

    
    
  </div>

  


  

  
  

<div class="single-pagination">
    <hr />

    <div class="flex">

        <div class="single-pagination-prev">
            
            <div class="single-pagination-container-prev">
                <div class="single-pagination-text">←</div>
                <div class="single-pagination-text">
                    <a href="/curiosities/2024-07-27/openapi-function-calling-blog/">
                        OpenAPI to Function Calling: A Comprehensive Guide
                    </a>
                </div>
            </div>
            
        </div>

        <div class="single-pagination-next">
            
            <div class="single-pagination-container-next">
                <div class="single-pagination-text">
                    <a href="/curiosities/2025-01-12/meh-ai/">
                        Meh.ai
                    </a>
                </div>
                <div class="single-pagination-text">→</div>
            </div>
            
        </div>

    </div>

    <hr />
</div>



  

  

  
  <div class="back-to-top">
    <a href="#top">
      back to top
    </a>
  </div>
  

</div>


    </main>
  </div>

  <footer>
    

    
    <p>Powered by
        <a href="https://gohugo.io/">Hugo</a>
        and
        <a href="https://github.com/tomfran/typo">tomfran/typo</a>
    </p>
    
    
    


  </footer>

  
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">
<script defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script>

<script defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.body);"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ]
    });
  });
</script>
  

</body>

<script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    document.body.classList.remove("auto");
    let cls = "light";
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);
  }

  function invertBody() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invertBody);
  }

  setTheme();

</script>

<script defer src="/js/copy-code.js"></script>
</html>